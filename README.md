# Учебный проект-сайт "Система контроля дефектов"

## Описание проекта

Система Контроля Дефектов - это полнофункциональное веб-приложение для отслеживания и управления дефектами в проектах. Система поддерживает ролевую модель с тремя типами пользователей: инженер, менеджер и наблюдатель. Приложение позволяет создавать проекты, управлять дефектами, назначать исполнителей, отслеживать статусы.

Проект состоит из двух основных частей:
- **Бэкенд**: API-сервер на базе Java с использованием Spring Boot и базы данных - PostgreSQL.
- **Фронтенд**: Веб-интерфейс на React и Tailwind CSS.

## Функциональность

### Основные возможности
- **Аутентификация и авторизация**: JWT-токены, ролевая модель доступа.
- **Управление пользователями**: Регистрация, профили, роли.
- **Управление проектами**: Создание, редактирование, управление доступом пользователей к проектам.
- **Отслеживание дефектов**: Создание, редактирование, назначение исполнителей и наблюдателей, изменение статусов и приоритетов.
- **Вложения и комментарии**: Прикрепление файлов к дефектам, обсуждение в комментариях.
- **Графики и аналитика**: Визуализация данных с помощью диаграмм.

### Роли пользователей
- **Инженер**: Создание и редактирование дефектов в доступных проектах.
- **Менеджер**: Управление дефектами, назначение исполнителей, генерация отчетов.
- **Наблюдатель**: Просмотр допустимых проектов и их дефектов.

Подробные диаграммы прецедентов и пользовательских историй доступны в [diagrams.md](./diagrams.md).

## Технологии

### Бэкенд
- **Spring Boot**: Фреймворк для Java.
- **PostgreSQL**: Реляционная база данных.
- **JWT и Spring Security**: Аутентификация и авторизация.
- **Swagger**: Документация API.
- **bcrypt**: Хеширование паролей.

### Фронтенд
- **React**: Библиотека для создания пользовательских интерфейсов.
- **Tailwind CSS**: CSS-фреймворк для стилизации.

## Предварительные требования

- **Node.js** версии 18 или выше.
- **Java** версии 17 или выше.
- **npm** или **yarn**.
- **PostgreSQL** версии 12 или выше.
- **Git** для клонирования репозитория.

## Установка

1. Клонируйте репозиторий:
   ```bash
   git clone <repository-url>
   cd SiteDefectManagef
   ```

2. Установите зависимости для бэкенда:
   ```bash
   cd backend
   npm install
   ```

3. Установите зависимости для фронтенда:
   ```bash
   cd ../frontend
   npm install
   ```

## Конфигурация

### Бэкенд
Создайте файл `.env` в директории `backend/` со следующими переменными:

```env
# База данных
DB_HOST=localhost
DB_PORT=5432
DB_USERNAME=your_username
DB_PASSWORD=your_password
DB_DATABASE=defects_db

# JWT
JWT_SECRET=your_jwt_secret_key

# Порт сервера (опционально, по умолчанию 3001)
PORT=3001
```

### Фронтенд
Создайте файл `.env.local` в директории `frontend/`:

```env
# URL бэкенд API
NEXT_PUBLIC_API_URL=http://localhost:3001
```

## Запуск приложения

### Локальный запуск

1. Запустите PostgreSQL и создайте базу данных `defects_db`.

2. Запустите бэкенд:
   ```bash
   cd backend
   npm run start:dev
   ```
   Бэкенд будет доступен по адресу: http://localhost:3001
   Swagger документация: http://localhost:3001/api

3. Запустите фронтенд:
   ```bash
   cd frontend
   npm run dev
   ```
   Фронтенд будет доступен по адресу: http://localhost:3000

### Продакшн сборка

1. Соберите бэкенд:
   ```bash
   cd backend
   npm run build
   npm run start:prod
   ```

2. Соберите фронтенд:
   ```bash
   cd frontend
   npm run build
   npm run start
   ```

## Развертывание на тестовом сервере

### Предварительная подготовка сервера
1. Установите Node.js (версия 18+) на сервер.
2. Установите PostgreSQL и создайте базу данных.
3. Установите Git.
4. Настройте firewall для портов 80/443 (для веб-сервера) и порта базы данных.

### Шаги развертывания

1. **Клонируйте репозиторий на сервер:**
   ```bash
   git clone <repository-url>
   cd system_control_defects
   ```

2. **Настройте переменные окружения:**
   - Создайте `.env` файл в `backend/` с реальными данными сервера.
   - Создайте `.env.local` в `frontend/` с URL бэкенд API.

3. **Установите зависимости:**
   ```bash
   cd backend && npm ci
   cd ../frontend && npm ci
   ```

4. **Соберите приложения:**
   ```bash
   cd backend && npm run build
   cd ../frontend && npm run build
   ```

5. **Запустите приложения:**
   - Для бэкенда: `npm run start:prod` (или используйте PM2 для управления процессами)
   - Для фронтенда: `npm run start`


### Мониторинг и обслуживание
- Настройте логирование (используйте Winston или встроенные логи NestJS).
- Регулярно обновляйте зависимости и проверяйте безопасность.
- Настройте бэкапы базы данных.

## Пользовательская документация

### Вход в систему
1. Откройте приложение в браузере.
2. Введите логин и пароль.
3. Выберите роль при регистрации (только для Лидера).

### Работа с проектами
- **Менеджер**: Создает проекты, управляет доступом пользователей.
- **Инженер/Наблюдатель**: Просматривает доступные проекты

### Работа с дефектами
- **Создание дефекта**: Инженер может создать дефект в доступном проекте.
- **Редактирование**: Менеджер назначает исполнителей, меняет статусы.
- **Вложения**: Прикрепляйте файлы к дефектам.
- **Комментарии**: Обсуждайте дефекты в комментариях.

### Отчеты
- Менеджер может генерировать отчеты по дефектам в формате Excel.

## Обучение

### Для новых пользователей
1. **Регистрация**: Обратитесь к Менеджеру для создания аккаунта.
2. **Знакомство с интерфейсом**: Изучите навигацию и основные разделы.
3. **Тренировка**: Создайте тестовый проект и дефект.

### Руководство для Менеджера
1. Создайте пользователей с соответствующими ролями.
2. Создайте проекты и назначьте пользователей.
3. Отслеживайте общую активность через дашборд.
1. Просмотрите дефекты в проектах.
3. Измените статусы по мере решения.
4. Генерируйте отчеты для руководства.

### Руководство для Инженера
1. Войдите в систему.
2. Выберите проект.
3. Создайте дефект с описанием проблемы.
4. Прикрепите необходимые файлы.

### Руководство для Наблюдателя
1. Просмотрите дефекты в проектах и проекты

## API документация

API документация доступна через Swagger UI по адресу: `http://your-server:3001/api`

Основные эндпоинты:
- `POST /auth/login` - Вход в систему
- `GET /projects` - Получение списка проектов
- `POST /defects` - Создание дефекта
## Тестирование

### Запуск тестов
```bash
# Бэкенд
cd frontend/tests
npm run test

# E2E тесты
npm run test:e2e
```

### Ручное тестирование
1. Создайте тестового пользователя.
2. Создайте проект.
3. Создайте и отредактируйте дефект.
4. Проверьте генерацию отчетов.


